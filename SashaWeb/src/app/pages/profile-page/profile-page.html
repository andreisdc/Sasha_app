<div class="profile-container" *ngIf="user; else loadingTemplate">
  <div class="profile-card">
    <!-- StÃ¢nga: Avatar -->
    <div class="avatar-section">
      <div class="avatar-wrapper" 
           (mouseenter)="showUpload = true" 
           (mouseleave)="showUpload = false">
        <img *ngIf="user.profilePicture; else defaultAvatar" 
             [src]="user.profilePicture" 
             class="avatar" />
        <ng-template #defaultAvatar>
          <div class="avatar">{{ user.username.charAt(0).toUpperCase() }}</div>
        </ng-template>
        <input *ngIf="showUpload" type="file" (change)="onFileChange($event)" class="file-input" />
      </div>
    </div>

    <!-- Dreapta: Info -->
    <div class="info-section">
      <h2>{{ user.firstName }} {{ user.lastName }}</h2>

      <div class="field">
        <label>Username</label>
        <div class="editable">
          <input *ngIf="editingUsername" type="text" [(ngModel)]="user.username" />
          <span *ngIf="!editingUsername">{{ user.username }}</span>
          <i class="fas fa-pencil-alt edit-icon" (click)="toggleUsernameEdit()"></i>
        </div>
      </div>

      <div class="field">
        <label>Email</label>
        <span>{{ user.email }}</span>
      </div>

      <div class="field">
        <label>Phone Number</label>
        <div class="editable">
          <input *ngIf="editingPhone" type="text" [(ngModel)]="user.phoneNumber" />
          <span *ngIf="!editingPhone">{{ user.phoneNumber }}</span>
          <i class="fas fa-pencil-alt edit-icon" (click)="togglePhoneEdit()"></i>
        </div>
      </div>

      <div class="field rating">
        <label>Rating</label>
        <span *ngFor="let _ of getFilledStars()"><i class="fas fa-star filled-star"></i></span>
        <span *ngFor="let _ of getEmptyStars()"><i class="far fa-star empty-star"></i></span>
      </div>

      <button class="save-btn" (click)="saveChanges()">Save</button>
    </div>
  </div>
</div>

<ng-template #loadingTemplate>
  <div class="loading-bar">
    <div class="loader"></div>
  </div>
</ng-template>
