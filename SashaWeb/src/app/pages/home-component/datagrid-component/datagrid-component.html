<div class="properties-container">
  <!-- Loading State -->
  <nz-spin nzTip="Loading properties..." [nzSpinning]="loading()" *ngIf="loading()">
    <div style="height: 200px;"></div>
  </nz-spin>

  <!-- Error State -->
  <div *ngIf="error() && !loading()" class="error-state">
    <nz-card>
      <div class="error-content">
        <nz-icon nzType="exclamation-circle" nzTheme="twotone" [nzTwotoneColor]="'#ff4d4f'"></nz-icon>
        <h3>{{ error() }}</h3>
        <button nz-button nzType="primary" (click)="loadProperties()">
          <span nz-icon nzType="reload"></span>
          Try Again
        </button>
      </div>
    </nz-card>
  </div>

  <!-- Properties Grid -->
  <div *ngIf="!loading() && !error()" class="properties-grid">
    <!-- Header -->
    <div class="grid-header">
      <h2>Explore Properties</h2>
      <p class="subtitle">{{ totalProperties() }} properties available</p>
    </div>

    <!-- Properties Grid -->
    <div class="properties-cards">
      <div class="properties-grid-layout">
        <nz-card
          *ngFor="let property of paginatedProperties()"
          class="property-card"
          [nzHoverable]="true"
          (click)="navigateToProperty(property.id)"
        >
          <!-- Property Image -->
          <div class="property-image-container">
            <img
              [src]="property.images[0] || '/assets/images/placeholder-property.jpg'"
              [alt]="property.title || property.title"
              class="property-image"
            />
            
          </div>

          <!-- Property Content -->
          <div class="property-content">
            <div class="property-location">
              <span class="location-text">{{ property.city }}, {{ property.country }}</span>
              <nz-tag class="property-type-tag">
                <nz-icon [nzType]="getPropertyTypeIcon(property.propertyType)"></nz-icon>
                {{ getPropertyTypeLabel(property.propertyType) }}
              </nz-tag>
            </div>

            <h3 class="property-name">{{ property.title || property.title }}</h3>

            <div class="property-rating" *ngIf="property.averageRating > 0">
              <nz-rate 
                [ngModel]="property.averageRating" 
                nzDisabled 
                class="rating-stars"
              ></nz-rate>
              <span class="rating-value">{{ property.averageRating.toFixed(1) }} ({{ property.reviewCount }})</span>
            </div>

            <div class="property-rating" *ngIf="property.averageRating === 0">
              <span class="no-reviews">No reviews</span>
            </div>

            <div class="property-price">
              <span class="price-amount">{{ formatPrice(property.pricePerNight) }}</span>
              <span class="price-period">night</span>
            </div>
          </div>
        </nz-card>
      </div>
    </div>

    <!-- Pagination -->
    <div class="pagination-container" *ngIf="totalProperties() > pageSize()">
      <nz-pagination
        [nzPageIndex]="pageIndex()"
        [nzTotal]="totalProperties()"
        [nzPageSize]="pageSize()"
        (nzPageIndexChange)="onPageChange($event)"
        nzShowSizeChanger
        [nzPageSizeOptions]="[12, 24, 48, 96]"
      ></nz-pagination>
    </div>
  </div>
</div>